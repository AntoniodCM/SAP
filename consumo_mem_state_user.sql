SELECT HOST, PORT, DB_USER, CAST(MAX(MEMORY_SIZE/(1024*1024*1024)) AS DECIMAL(10,2)) as MAYOR_EJECUCION_GB, CAST(SUM(DISTINCT MEMORY_SIZE/(1024*1024*1024)) AS DECIMAL(10,2)) as SUMA_TOTAL_GB, count(distinct statement_id) as NUM_STATEMENTS,  right (concat ('0' , RTRIM(EXTRACT (HOUR FROM (add_seconds (TO_TIMESTAMP (CURRENT_TIMESTAMP), 3600*23) ))) ),2) || ':00:00' AS HORA FROM M_EXPENSIVE_STATEMENTS WHERE START_TIME between TO_TIMESTAMP((select right (concat ('0' , RTRIM(EXTRACT (YEAR FROM (CURRENT_DATE))) ) ,4) || '/' || right (concat ('0' , RTRIM(EXTRACT (MONTH FROM (CURRENT_DATE))) ) ,2) || '/' ||  right (concat ('0' , RTRIM(EXTRACT (DAY FROM (CURRENT_DATE))) ),2) || ' ' || right (concat ('0' , RTRIM(EXTRACT (HOUR FROM (add_seconds (TO_TIMESTAMP (CURRENT_TIMESTAMP), 3600*23) ))) ),2) || ':00:00' from dummy),'YYYY/MM/DD HH24:mi:SS') and TO_TIMESTAMP((select right (concat ('0' , RTRIM(EXTRACT (YEAR FROM (CURRENT_DATE))) ) ,4) || '/' || right (concat ('0' , RTRIM(EXTRACT (MONTH FROM (CURRENT_DATE))) ) ,2) || '/' ||  right (concat ('0' , RTRIM(EXTRACT (DAY FROM (CURRENT_DATE))) ),2) || ' ' || right (concat ('0' , RTRIM(EXTRACT (HOUR FROM (CURRENT_TIME))) ),2)  || ':00:00' from dummy),'YYYY/MM/DD HH24:mi:SS')GROUP BY HOST, PORT, DB_USER ORDER BY DB_USER;
